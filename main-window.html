<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Screen Streaming Control</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 30px;
      backdrop-filter: blur(10px);
    }
    
    h1 {
      text-align: center;
      margin-bottom: 30px;
      font-size: 28px;
    }
    
    .settings-section {
      margin-bottom: 25px;
    }
    
    .settings-section h2 {
      font-size: 18px;
      margin-bottom: 15px;
      border-bottom: 2px solid rgba(255, 255, 255, 0.3);
      padding-bottom: 10px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      font-size: 14px;
    }
    
    select, input {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      font-size: 14px;
      cursor: pointer;
    }
    
    select option {
      background: #764ba2;
      color: white;
    }
    
    select:hover, input:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    
    .info-text {
      font-size: 12px;
      opacity: 0.8;
      margin-top: 5px;
      font-style: italic;
    }
    
    .server-section {
      margin-top: 30px;
      padding-top: 25px;
      border-top: 2px solid rgba(255, 255, 255, 0.3);
    }
    
    .server-url {
      background: rgba(255, 255, 255, 0.2);
      padding: 15px;
      border-radius: 10px;
      margin: 15px 0;
      font-size: 16px;
      font-weight: 600;
      text-align: center;
      cursor: pointer;
      user-select: all;
      word-break: break-all;
    }
    
    .server-url:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    
    .server-url.inactive {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .button-group {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }
    
    button {
      flex: 1;
      padding: 15px 25px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .btn-start {
      background: #4CAF50;
      color: white;
    }
    
    .btn-start:hover:not(:disabled) {
      background: #45a049;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
    }
    
    .btn-stop {
      background: #f44336;
      color: white;
    }
    
    .btn-stop:hover:not(:disabled) {
      background: #da190b;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(244, 67, 54, 0.4);
    }
    
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .status {
      text-align: center;
      padding: 12px;
      border-radius: 8px;
      margin-top: 20px;
      font-weight: 600;
    }
    
    .status.running {
      background: rgba(76, 175, 80, 0.3);
    }
    
    .status.stopped {
      background: rgba(244, 67, 54, 0.3);
    }
    
    .status-text {
      font-size: 14px;
      margin-top: 10px;
      opacity: 0.9;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üñ•Ô∏è Screen Streaming Control</h1>
    
    <div class="settings-section">
      <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏</h2>
      
      <div class="form-group">
        <label for="resolutionSelect">–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:</label>
        <select id="resolutionSelect">
          <option value="native" selected>–ù–∞—Ç–∏–≤–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è</option>
          <option value="854x480">480p (854x480) - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞</option>
          <option value="1280x720">720p (1280x720) - –û–ø—Ç–∏–º–∞–ª—å–Ω–æ</option>
          <option value="1920x1080">1080p (1920x1080) - –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ</option>
        </select>
        <div class="info-text">–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ –¥–ª—è —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏</div>
      </div>
      
      <div class="form-group">
        <label for="bitrateSelect">–ë–∏—Ç—Ä–µ–π—Ç:</label>
        <select id="bitrateSelect">
          <option value="1000000">1 Mbps - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞</option>
          <option value="1500000" selected>1.5 Mbps - –û–ø—Ç–∏–º–∞–ª—å–Ω–æ</option>
          <option value="2000000">2 Mbps - –ù–∏–∑–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞</option>
          <option value="3000000">3 Mbps - –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ</option>
          <option value="4000000">4 Mbps - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ</option>
        </select>
        <div class="info-text">–ë–∏—Ç—Ä–µ–π—Ç –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –∏ –∑–∞–¥–µ—Ä–∂–∫—É</div>
      </div>
      
      <div class="form-group">
        <label for="fpsSelect">–ß–∞—Å—Ç–æ—Ç–∞ –∫–∞–¥—Ä–æ–≤:</label>
        <select id="fpsSelect">
          <option value="24">24 FPS - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞</option>
          <option value="30" selected>30 FPS - –û–ø—Ç–∏–º–∞–ª—å–Ω–æ</option>
          <option value="60">60 FPS - –ü–ª–∞–≤–Ω–æ–µ –≤–∏–¥–µ–æ</option>
        </select>
        <div class="info-text">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–¥—Ä–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É</div>
      </div>
    </div>
    
    <div class="server-section">
      <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–º</h2>
      
      <div class="server-url" id="serverUrl" onclick="copyUrl()">
        –°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω
      </div>
      
      <div class="button-group">
        <button id="startBtn" class="btn-start" onclick="startServer()">‚ñ∂ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä</button>
        <button id="stopBtn" class="btn-stop" onclick="stopServer()" disabled>‚èπ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä</button>
      </div>
      
      <div class="status stopped" id="status">
        <div>–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</div>
        <div class="status-text">–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä</div>
      </div>
    </div>
  </div>
  
  <script>
    const { ipcRenderer } = require('electron');
    
    // Load saved settings
    function loadSettings() {
      const saved = localStorage.getItem('serverSettings');
      if (saved) {
        try {
          const settings = JSON.parse(saved);
          if (settings.resolution) {
            document.getElementById('resolutionSelect').value = settings.resolution === 'native' ? 'native' : `${settings.resolution.width}x${settings.resolution.height}`;
          }
          document.getElementById('bitrateSelect').value = settings.bitrate || 1500000;
          document.getElementById('fpsSelect').value = settings.fps || 30;
        } catch (e) {
          console.error('Error loading settings:', e);
        }
      }
    }
    
    // Save settings
    function saveSettings() {
      const resolutionValue = document.getElementById('resolutionSelect').value;
      const resolution = resolutionValue === 'native' ? null : {
        width: parseInt(resolutionValue.split('x')[0]),
        height: parseInt(resolutionValue.split('x')[1])
      };
      
      const settings = {
        resolution: resolution,
        bitrate: parseInt(document.getElementById('bitrateSelect').value),
        fps: parseInt(document.getElementById('fpsSelect').value)
      };
      
      localStorage.setItem('serverSettings', JSON.stringify(settings));
      return settings;
    }
    
    // Update UI based on server state
    function updateUI(running, url) {
      const startBtn = document.getElementById('startBtn');
      const stopBtn = document.getElementById('stopBtn');
      const serverUrl = document.getElementById('serverUrl');
      const status = document.getElementById('status');
      
      if (running) {
        startBtn.disabled = true;
        stopBtn.disabled = false;
        serverUrl.textContent = url || '–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω';
        serverUrl.classList.remove('inactive');
        status.className = 'status running';
        status.innerHTML = '<div>‚úì –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω</div><div class="status-text">–û—Ç–∫—Ä–æ–π—Ç–µ URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ –Ω–∞ –¥—Ä—É–≥–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</div>';
      } else {
        startBtn.disabled = false;
        stopBtn.disabled = true;
        serverUrl.textContent = '–°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω';
        serverUrl.classList.add('inactive');
        status.className = 'status stopped';
        status.innerHTML = '<div>–°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</div><div class="status-text">–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä</div>';
      }
    }
    
    // Start server
    function startServer() {
      const settings = saveSettings();
      ipcRenderer.send('start-server', settings);
    }
    
    // Stop server
    function stopServer() {
      ipcRenderer.send('stop-server');
    }
    
    // Copy URL to clipboard
    function copyUrl() {
      const url = document.getElementById('serverUrl').textContent;
      if (url && url !== '–°–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω') {
        navigator.clipboard.writeText(url).then(() => {
          const serverUrl = document.getElementById('serverUrl');
          const originalText = serverUrl.textContent;
          serverUrl.textContent = '‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
          setTimeout(() => {
            serverUrl.textContent = originalText;
          }, 2000);
        });
      }
    }
    
    // Listen for server state updates
    ipcRenderer.on('server-started', (event, url) => {
      updateUI(true, url);
    });
    
    ipcRenderer.on('server-stopped', () => {
      updateUI(false);
    });
    
    // Load settings on startup
    try {
      loadSettings();
      updateUI(false);
      console.log('UI initialized');
    } catch (error) {
      console.error('Error initializing UI:', error);
    }
    
    // Save settings when changed
    document.getElementById('resolutionSelect').addEventListener('change', saveSettings);
    document.getElementById('bitrateSelect').addEventListener('change', saveSettings);
    document.getElementById('fpsSelect').addEventListener('change', saveSettings);
    
    // Handle IPC errors
    ipcRenderer.on('error', (event, error) => {
      console.error('IPC error:', error);
      const status = document.getElementById('status');
      status.className = 'status stopped';
      status.innerHTML = '<div>–û—à–∏–±–∫–∞</div><div class="status-text">' + error + '</div>';
    });
  </script>
</body>
</html>

